# Log Analyzer â€“ SM-W lite+ (IE Tecnologia)

![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)
![Platform](https://img.shields.io/badge/Platform-macOS%20%7C%20Linux%20%7C%20Windows-lightgrey)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Status](https://img.shields.io/badge/Status-Stable-brightgreen)

This repository provides a Python-based system for automated analysis of log files generated by the **SM-W lite+** electrical monitoring device (IE Tecnologia), focused on Phase A measurements.

The tool performs:

- ğŸ“ˆ Time-series plots for RMS Voltage (V), RMS Current (A) and Active Power (W)  
- âš¡ Daily energy usage calculation (kWh/day) based on `epa_c`  
- ğŸš¨ Outlier detection using the IQR method (voltage, current, power)  
- ğŸ“ Automatic reporting with statistics, kWh/day and outliers  
- ğŸ’¾ Interactive menu to select the default `./logs` folder or any custom path  
- ğŸ“‘ Report preview in the terminal, save to `.txt` file or both  

Works on macOS, Linux and Windows.

---

## ğŸ“‚ Repository Layout

```text
.
â”œâ”€â”€ analite.py       # Main analysis script
â”œâ”€â”€ README.md        # Documentation in Portuguese
â”œâ”€â”€ README_EN.md     # Documentation in English
â””â”€â”€ logs/            # (optional) Default folder for .txt log files
```

---

## ğŸ“„ Log File Format

Each line in the log files uses the following format:

```text
hour : minute : second : pa : epa_c : epa_g : iarms : uarms
```

### Field Description

| Field     | Description                                   | Unit |
|-----------|-----------------------------------------------|------|
| **hour**  | Hour of the measurement (0â€“23)                | h    |
| **minute**| Minute of the measurement (0â€“59)              | min  |
| **second**| Second of the measurement (0â€“59)              | s    |
| **pa**    | Active power, Phase A                         | W    |
| **epa_c** | Accumulated consumed energy, Phase A          | kWh  |
| **epa_g** | Accumulated generated energy, Phase A         | kWh  |
| **iarms** | RMS current, Phase A                          | A    |
| **uarms** | RMS voltage, Phase A                          | V    |

### Scaling Note

The SM-W lite+ exports some fields **scaled by Ã—100**:

- `pa`
- `iarms`
- `uarms`

The script automatically converts them to real-world units:

- `pa_W` â†’ Watts  
- `iarms_A` â†’ Amperes  
- `uarms_V` â†’ Volts  

---

## ğŸ›  Installation

### Requirement: Python 3.10+

Using a virtual environment is recommended.

```bash
python3.10 -m venv .venv
source .venv/bin/activate   # macOS / Linux
.\.venv\Scriptsctivate    # Windows
```

Install dependencies:

```bash
pip install "numpy<2.0" "pandas<2.2" matplotlib
```

---

## â–¶ï¸ Usage

1. Place your `.txt` log files in the desired folder, for example:

```text
logs/
 â”œâ”€â”€ 15112025.txt
 â”œâ”€â”€ 16112025.txt
 â”œâ”€â”€ 17112025.txt
 â”œâ”€â”€ 18112025.txt
 â””â”€â”€ 19112025.txt
```

2. Run the script:

```bash
python analise.py
```

3. Select the log folder:

```text
1 - Use default './logs/'
2 - Enter a custom folder path
```

4. Choose how to generate the report:

```text
1 - Display only on the terminal
2 - Save only to a .txt file
3 - Display and save
4 - Do not generate report
```

The report (if saved) is created in the same folder as the log files.

---

## ğŸ“ˆ Generated Graphs

The script automatically creates:

| File name       | Description                                    |
|-----------------|------------------------------------------------|
| `tensao.png`    | RMS Voltage (Phase A) vs. time                 |
| `corrente.png`  | RMS Current (Phase A) vs. time                 |
| `potencia.png`  | Active Power (Phase A) vs. time                |

All plots are saved in the folder that contains the log files.

---

## âš¡ Daily kWh Calculation

Daily consumption is estimated as:

```text
kWh_day = max(epa_c) - min(epa_c) per date
```

Example output:

```text
            kWh_day
2025-11-15    3.10
2025-11-16    3.05
2025-11-17    3.20
2025-11-18    3.08
```

If the SM-W lite+ is configured with a different scale, adjust the factor in the `calcular_kwh_por_dia` function accordingly.

---

## ğŸš¨ Outlier Detection (IQR)

For each of the following:

- `uarms_V` (voltage)  
- `iarms_A` (current)  
- `pa_W` (power)

the script uses the Interquartile Range (IQR) method:

```text
outlier < Q1 âˆ’ 1.5Â·IQR
outlier > Q3 + 1.5Â·IQR
```

The report shows:

- lower and upper bounds  
- Q1 and Q3  
- total number of outliers  
- up to 10 timestamp examples per variable  

---

## ğŸ“ Automatic Report

The report aggregates:

- basic statistics (`pandas.DataFrame.describe()`)  
- daily kWh  
- outlier bounds and samples  

By default, it is saved as:

```text
relatorio_analise_logs.txt
```

---

## ğŸ”§ Customization

This tool can be extended to:

- include cost estimation (currency per day/month)  
- export plots and report to PDF  
- compare periods (e.g., before/after electrical corrections)  
- support multiple phases (A/B/C)  

---

## ğŸ“œ License

MIT License
